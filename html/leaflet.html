<!DOCTYPE html>
<html>
  <head>
    <!-- Leaflet CSSとスタイルのリンク -->
    <link
      rel="stylesheet"
      href="https://unpkg.com/leaflet@1.7.1/dist/leaflet.css"
    />
    <style>
      /* 地図のコンテナのスタイル */
      #map {
        position: absolute;
        top: 0;
        bottom: 0;
        left: 0;
        right: 0;
      }
    </style>
  </head>
  <body>
    <div id="map"></div>

    <!-- Leaflet JavaScriptのリンク -->
    <script src="https://unpkg.com/leaflet@1.7.1/dist/leaflet.js"></script>
    <script>
      // import data from "./target.json" assert { type: "json" }

      var data = [
        {
          geometry: [
            [137.0532116, 35.3533617],
            [137.0531178, 35.3535322],
            [137.0530194, 35.3538645],
            [137.0529557, 35.3539268],
            [137.052809, 35.3539751],
            [137.0526579, 35.3540078],
            [137.052534, 35.35404],
            [137.0524052, 35.3541338],
            [137.0522985, 35.3542554],
            [137.0522281, 35.3543762],
            [137.0522171, 35.354451],
            [137.0522282, 35.354518],
            [137.0525365, 35.3549067],
            [137.0525953, 35.3550198],
            [137.0526251, 35.355128],
            [137.052684, 35.3556328],
            [137.05278, 35.355834],
            [137.052918, 35.356155],
            [137.053193, 35.356684],
            [137.053427, 35.357084],
            [137.053577, 35.35739],
            [137.053584, 35.357405],
            [137.053756, 35.3578478],
            [137.0538803, 35.3581516],
            [137.0539147, 35.3582519],
            [137.0541706, 35.358999],
            [137.054286, 35.3592405],
            [137.0543217, 35.3595748],
            [137.0543792, 35.3599618],
            [137.0544217, 35.3601658],
            [137.0544831, 35.3602906],
            [137.0545853, 35.360396],
            [137.0547074, 35.3605475],
            [137.0547622, 35.3606117],
            [137.05485, 35.3607167],
            [137.0549538, 35.3608604],
            [137.0549886, 35.3609426],
            [137.0550081, 35.3610372],
            [137.0550107, 35.3610577],
            [137.0550195, 35.3611278],
            [137.0550054, 35.3612164],
            [137.054801, 35.3619196],
            [137.0547536, 35.3620791],
            [137.0546274, 35.3625027],
            [137.054602, 35.362588],
            [137.054298, 35.363478],
            [137.054272, 35.363636],
            [137.054278, 35.363793],
            [137.054333, 35.363996],
            [137.054485, 35.364272],
            [137.054767, 35.364734],
            [137.054814, 35.364864],
            [137.054829, 35.365016],
            [137.054814, 35.365084],
            [137.054725, 35.365376],
            [137.054657, 35.365664],
            [137.0546606, 35.3658431],
            [137.0546728, 35.3659611],
            [137.054695, 35.3660604],
            [137.0547407, 35.3662119],
            [137.0547715, 35.3663319],
            [137.0548392, 35.3664509],
            [137.0549092, 35.3665555],
            [137.0550263, 35.3666687],
            [137.0551217, 35.3667339],
            [137.0552207, 35.3667876],
            [137.055585, 35.366948],
            [137.055736, 35.367089],
            [137.056004, 35.36741],
            [137.056155, 35.367534],
            [137.056293, 35.367618],
            [137.0568476, 35.3678817],
            [137.0571654, 35.3680402],
            [137.0575397, 35.3683143],
            [137.0578848, 35.3685837],
            [137.0580005, 35.3686585],
            [137.058142, 35.3687257],
            [137.0590015, 35.3690578],
            [137.0590637, 35.3690818],
            [137.0591588, 35.3690985],
            [137.0594354, 35.3690836],
            [137.0595031, 35.3690969],
            [137.0595626, 35.3691376],
            [137.0595997, 35.3692068],
            [137.0598555, 35.3703352],
            [137.0598918, 35.3703919],
            [137.0599604, 35.3704303],
            [137.0600839, 35.3704817],
            [137.0601495, 35.37048],
            [137.0601959, 35.3704542],
            [137.0602347, 35.3704103],
            [137.0602357, 35.3703492],
            [137.0601119, 35.3702186],
            [137.0600895, 35.3701575],
            [137.0600979, 35.3700956],
            [137.0602592, 35.3696521],
            [137.0602831, 35.3695941],
            [137.0603419, 35.369546],
            [137.0604045, 35.369546],
            [137.0604309, 35.369546],
            [137.0604927, 35.3695657],
            [137.0605278, 35.3696326],
            [137.0605819, 35.3700108],
            [137.0606112, 35.3700762],
            [137.0606762, 35.3701404],
            [137.061055, 35.370486],
            [137.061172, 35.370661],
            [137.061193, 35.370739],
            [137.0611625, 35.3707975],
            [137.0611089, 35.3708465],
            [137.0609073, 35.3708928],
            [137.0608285, 35.3709191],
            [137.0607708, 35.3709711],
            [137.0607561, 35.3710783],
            [137.0607088, 35.3716492],
            [137.0605524, 35.3726535],
            [137.0605123, 35.3728685],
            [137.0605215, 35.3729413],
            [137.0605377, 35.3729895],
            [137.0605692, 35.3730418],
            [137.0607806, 35.3734204],
            [137.0608283, 35.3735576],
            [137.0608436, 35.3736543],
            [137.0608697, 35.3737386],
            [137.0609218, 35.3738652],
            [137.0610173, 35.3740069],
            [137.0610943, 35.374112],
            [137.0611736, 35.3741925],
            [137.0612573, 35.3742464],
            [137.0614533, 35.3744008],
            [137.0614994, 35.3744502],
            [137.0615367, 35.3745066],
            [137.0615683, 35.3745983],
            [137.0617509, 35.3752462],
            [137.0617768, 35.3753965],
            [137.0617603, 35.3755572],
            [137.0617186, 35.3756825],
            [137.0614678, 35.3760801],
            [137.0610403, 35.376738],
            [137.0606537, 35.3774203],
            [137.0605647, 35.3776744],
            [137.0605343, 35.3778948],
            [137.060515, 35.378322],
            [137.0604378, 35.3785446],
            [137.0603804, 35.3786276],
            [137.0602917, 35.3787559],
            [137.0598861, 35.3790381],
            [137.0597536, 35.3792249],
            [137.0597162, 35.3793232],
            [137.0596869, 35.3794821],
            [137.0596547, 35.3798419],
          ],
          geometory_angle_total: 1768.7311105876,
        },
        {
          geometry: [
            [137.0338598, 35.3744265],
            [137.033812, 35.374231],
            [137.033221, 35.373837],
            [137.033042, 35.37369],
            [137.032829, 35.373442],
            [137.032706, 35.373251],
            [137.032638, 35.373054],
            [137.032624, 35.372952],
            [137.032569, 35.372766],
            [137.032521, 35.372692],
            [137.032438, 35.372641],
            [137.032191, 35.372596],
            [137.032033, 35.372557],
            [137.031943, 35.3725],
            [137.031799, 35.372377],
            [137.031565, 35.372039],
            [137.031366, 35.371779],
            [137.031208, 35.37161],
            [137.03105, 35.371503],
            [137.030858, 35.371509],
            [137.030699, 35.371565],
            [137.030617, 35.3717],
            [137.030624, 35.371724],
            [137.030857, 35.372005],
            [137.031125, 35.37223],
            [137.031153, 35.37231],
            [137.031153, 35.372479],
            [137.03105, 35.372607],
            [137.030953, 35.372642],
            [137.030747, 35.372647],
            [137.03061, 35.372602],
            [137.030541, 35.372557],
            [137.029888, 35.371785],
            [137.029888, 35.371634],
            [137.029909, 35.371544],
            [137.029916, 35.371233],
            [137.029895, 35.371103],
            [137.0298331, 35.3709798],
            [137.0296811, 35.3707611],
            [137.0295149, 35.3705284],
            [137.0294016, 35.3703076],
            [137.0292752, 35.3701169],
            [137.029077, 35.3698989],
            [137.0290495, 35.3698694],
            [137.0288803, 35.3697419],
            [137.0288272, 35.3697019],
            [137.0285156, 35.3695597],
            [137.0281723, 35.3694771],
            [137.0279657, 35.369408],
            [137.027815, 35.3693272],
            [137.0276923, 35.3692346],
            [137.0276068, 35.3691272],
            [137.0275588, 35.369033],
            [137.0274984, 35.3688417],
            [137.027448, 35.368558],
            [137.0273383, 35.3680801],
            [137.0273099, 35.3679386],
            [137.027241, 35.3676561],
            [137.027152, 35.367426],
            [137.027055, 35.367251],
            [137.0267504, 35.3668204],
            [137.026714, 35.3667926],
            [137.0266659, 35.3667559],
            [137.0266339, 35.3667314],
            [137.0265895, 35.3666695],
            [137.0265425, 35.3665697],
            [137.0264136, 35.3662892],
            [137.0262452, 35.3658686],
            [137.0262315, 35.3657946],
            [137.026116, 35.3654591],
          ],
          geometory_angle_total: 915.4760554322,
        },
        {
          geometry: [
            [137.0004548, 35.3743498],
            [137.0004336, 35.3745886],
            [137.0003903, 35.3748235],
            [137.0003694, 35.3750441],
            [137.0004961, 35.3753101],
            [137.0006078, 35.3754559],
            [137.0007034, 35.3756092],
            [137.0007325, 35.3756998],
            [137.0007227, 35.375798],
            [137.0006654, 35.3758627],
            [137.0005872, 35.375951],
            [137.0004296, 35.3761273],
            [137.0002505, 35.3763875],
            [137.0000388, 35.3767593],
            [136.9999281, 35.3770514],
            [136.9998629, 35.3774284],
            [136.9998923, 35.3777126],
            [136.9999379, 35.377917],
            [136.9999151, 35.3781958],
            [136.9998629, 35.3784162],
            [136.9996513, 35.3788145],
            [136.9995168, 35.3791836],
            [136.9994168, 35.3795182],
            [136.9993972, 35.3797014],
            [136.999394, 35.3798714],
            [136.9993582, 35.3799484],
            [136.9992865, 35.3799882],
            [136.9991934, 35.379994],
            [136.9989185, 35.3799479],
            [136.9987089, 35.3799316],
            [136.9985854, 35.3799377],
            [136.998434, 35.379968],
            [136.998254, 35.380069],
            [136.9980413, 35.3802207],
            [136.9977763, 35.3803834],
            [136.9975054, 35.3805074],
            [136.9973234, 35.3806093],
            [136.9971941, 35.3807409],
            [136.997147, 35.38086],
            [136.997155, 35.381012],
            [136.997182, 35.381149],
            [136.9972479, 35.381462],
            [136.9972548, 35.3816153],
            [136.9972371, 35.3817673],
            [136.9970588, 35.3819846],
            [136.9969234, 35.3821377],
            [136.9967785, 35.3822962],
            [136.9967249, 35.3825182],
            [136.996741, 35.3828244],
            [136.9966592, 35.3830245],
            [136.9964084, 35.3833579],
            [136.9962957, 35.3835679],
            [136.9961616, 35.3840227],
            [136.9957703, 35.3846258],
            [136.995357, 35.385272],
            [136.9951669, 35.3855567],
            [136.9949696, 35.3858473],
            [136.994911, 35.385986],
            [136.994878, 35.3861332],
            [136.9949169, 35.3864959],
            [136.9948351, 35.3866961],
            [136.994711, 35.386859],
            [136.9945158, 35.387097],
            [136.9944583, 35.3871743],
          ],
          geometory_angle_total: 753.2397206475,
        },
        {
          geometry: [
            [136.9930285, 35.3341575],
            [136.9930949, 35.3341663],
            [136.9931767, 35.3341698],
            [136.9932446, 35.3341696],
            [136.993314, 35.3341645],
            [136.9933726, 35.3341464],
            [136.9934231, 35.3341253],
            [136.9934797, 35.3340939],
            [136.9938895, 35.3338285],
            [136.9940068, 35.3337587],
            [136.9940782, 35.3337238],
            [136.9941571, 35.3336914],
            [136.9942211, 35.3336734],
            [136.9942898, 35.3336626],
            [136.9943894, 35.333657],
            [136.9944941, 35.3336577],
            [136.9945879, 35.3336702],
            [136.9946874, 35.3336906],
            [136.994783, 35.3337347],
            [136.9948634, 35.333786],
            [136.9950626, 35.3339234],
            [136.9951845, 35.333988],
            [136.9966034, 35.3346245],
            [136.9968803, 35.3347915],
            [136.9970347, 35.3349492],
            [136.9972337, 35.3352163],
            [136.997378, 35.3354788],
            [136.997489, 35.3355552],
            [136.9976145, 35.3355753],
            [136.9977617, 35.33556],
            [136.9981829, 35.3354317],
            [136.9983098, 35.3354046],
            [136.9984685, 35.335414],
            [136.9986675, 35.3354811],
            [137.0009022, 35.3368531],
            [137.001194, 35.3369999],
            [137.0013778, 35.3370742],
            [137.0015807, 35.3371374],
            [137.0018887, 35.3371945],
            [137.0023879, 35.3372383],
            [137.0025802, 35.337271],
            [137.0027753, 35.337335],
            [137.0029117, 35.3374067],
            [137.0030809, 35.3375051],
            [137.0033919, 35.3377376],
            [137.0035552, 35.3378461],
            [137.0036894, 35.3379279],
            [137.0038755, 35.3380008],
            [137.0040453, 35.3380445],
            [137.004226, 35.3380658],
            [137.005109, 35.3381224],
            [137.0058029, 35.3381862],
            [137.0067725, 35.3382369],
            [137.0070629, 35.3382309],
            [137.0072643, 35.3381965],
            [137.007574, 35.3381355],
            [137.0077914, 35.3380839],
            [137.0079622, 35.338031],
            [137.0080865, 35.3379223],
            [137.0082649, 35.3377654],
            [137.0085143, 35.3375973],
            [137.0092298, 35.3372553],
            [137.0093882, 35.3372252],
            [137.0095588, 35.3372254],
            [137.0097022, 35.3372613],
          ],
          geometory_angle_total: 477.0823259195,
        },
        {
          geometry: [
            [137.044923, 35.36827],
            [137.043053, 35.368344],
            [137.042798, 35.368378],
            [137.042674, 35.368412],
            [137.042509, 35.368474],
            [137.042468, 35.368502],
            [137.042365, 35.368564],
            [137.042234, 35.368683],
            [137.042145, 35.368807],
            [137.042066, 35.368957],
            [137.042014, 35.369054],
            [137.041884, 35.36937],
            [137.041788, 35.369516],
            [137.041657, 35.369634],
            [137.041519, 35.369696],
            [137.041382, 35.369736],
            [137.040949, 35.369803],
            [137.040736, 35.369854],
            [137.040584, 35.369899],
            [137.040468, 35.369967],
            [137.040344, 35.370085],
            [137.040254, 35.370277],
            [137.040199, 35.370468],
            [137.040144, 35.370778],
            [137.040096, 35.370947],
            [137.040028, 35.371094],
            [137.039911, 35.371268],
            [137.039636, 35.371634],
            [137.039464, 35.371814],
            [137.039264, 35.371978],
            [137.039044, 35.37209],
            [137.038611, 35.372282],
            [137.038391, 35.372428],
            [137.03822, 35.372502],
            [137.038013, 35.372569],
            [137.037883, 35.372631],
            [137.037745, 35.372765],
            [137.037594, 35.372928],
            [137.037491, 35.37299],
            [137.037127, 35.373103],
            [137.037044, 35.373131],
            [137.036893, 35.373222],
            [137.036659, 35.373424],
            [137.036213, 35.373881],
            [137.035903, 35.374135],
            [137.035641, 35.37431],
            [137.035498, 35.374451],
            [137.03538, 35.374602],
            [137.03529, 35.374692],
            [137.035113, 35.374811],
            [137.034899, 35.374912],
            [137.034783, 35.375002],
            [137.034673, 35.375064],
          ],
          geometory_angle_total: 449.6116382097,
        },
      ]
      var latitude = 35.338218
      var longitude = 137.005638

      // 地図を初期化し、指定位置を中心にする
      var map = L.map("map").setView([latitude, longitude], 13)

      // OpenStreetMapのタイルレイヤーを追加
      L.tileLayer("https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png", {
        attribution:
          '&copy; <a href="https://www.openstreetmap.org/copyright">OpenStreetMap</a> contributors',
      }).addTo(map)

      // 緯度時計を逆転させる
      var polylines = data.map((x) => {
        return x.geometry.map((point) => [point[1], point[0]])
      })
      console.log(polylines)
      polylines.forEach((polyline) => {
        const ed = polyline[polyline.length - 1]
        const center = polyline[Math.floor(polyline.length / 2)]
        const st = polyline[0]
        const streetViewStUrl = `https://www.google.com/maps/@${st[0]},${st[1]},20?layer=c&cbll=${st[0]},${st[1]}&cbp=12,0,0,0,0`
        const streetViewCenterUrl = `https://www.google.com/maps/@${center[0]},${center[1]},20?layer=c&cbll=${center[0]},${center[1]}&cbp=12,0,0,0,0`
        const streetViewEdUrl = `https://www.google.com/maps/@${ed[0]},${ed[1]},20?layer=c&cbll=${ed[0]},${ed[1]}&cbp=12,0,0,0,0`
        L.polyline(polyline, {
          color: "blue",
          weight: 20,
          opacity: 0.3,
        })
          .bindPopup(
            `
            center: <a href="${streetViewCenterUrl}" target="_blank">streetViewCenter</a><br>
            `,
            { maxWidth: 400 }
          )
          .addTo(map)
      })
    </script>
  </body>
</html>
