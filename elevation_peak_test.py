import numpy as np
import matplotlib.pyplot as plt

# 波形サンプル
# list = [0.0, 1.779998779296875, 2.5409911586590397, 11.452094103782827, 23.69999999999999, 31.071569018004595, 33.51195196560968, 37.60948515627604, 41.976800185598336, 42.13111687674689, 43.77999267578127, 45.04000244140627, 41.12249755859375, 47.158249069604835, 46.15882528382451, 43.08000488281249, 42.020001220703136, 39.56747441542558, 40.75999755859374, 41.44000244140625, 42.66000976562498, 41.186667887369765, 41.11333211263019, 34.62000732421876, 32.2600036621094, 31.899999999999977, 40.7399963378906, 43.12000732421876, 42.74000244140626, 42.74000244140626, 44.420001220703114, 45.6199951171875, 46.632884488878176, 41.88740830273548, 41.3008774377837, 47.43999633789065, 54.220001220703125, 61.10369907519606, 63.812712418102706, 62.979998779296864, 63.01307676472925, 59.04185328617348, 69.06000366210935, 71.24000244140626, 82.25440265100514, 82.16000366210938, 87.76673006671444, 93.05999755859375, 101.6400085449219, 104.64000244140624, 112.5434032063132, 114.54000244140627, 111.55999755859375, 112.10616425552308, 111.24540806383237, 112.65999755859377, 121.75427165088729, 120.66000366210938, 122.51998901367188, 123.41999511718751, 124.47999877929686, 130.1162311406685, 127.47561204505217, 136.11800697537348, 146.21513182686232, 159.7884973443597, 162.17999267578125, 165.86738972633543, 167.4025153588949, 171.04293032502858, 182.20285668862368, 189.62633398289086, 202.3509891258575, 213.16000976562498, 216.9428606305804, 220.338873342252, 229.50726653080756, 240.57258529165767, 243.57999267578123, 244.50422713901378, 249.04774411998937, 265.240115544638, 275.8327553068482, 284.73449086732603, 282.7740541723756, 295.3544899623324, 310.86114838161666, 321.2400024414062, 325.9000122070313, 333.8799926757813, 336.75751301512673, 347.36327992481836, 355.7400024414062, 364.4180077672072, 362.76021040579235, 371.954858312512, 382.4000122070313, 395.3856376677883, 394.17218757971125, 401.5135482411073, 408.99237626392755, 411.03999023437495, 417.7713563997602, 423.81999511718755, 431.75433973939107, 445.2698515631214, 461.26186367736284, 459.82619032956404, 450.29442738744206, 442.56000976562495, 439.0213246572674, 422.8375623349242, 407.91999511718745, 402.91066604936464, 396.37501140607424, 381.32249865670224, 378.26256834364256, 366.1863649743766, 353.93999023437505, 345.65998535156245, 335.7934926698938, 329.4813420566936, 322.8813420566937, 320.91325280684487, 311.9999877929688, 302.9254749292244, 287.7199951171875, 275.4066446940103, 271.1399780273438, 262.0666373312728, 257.5910259602091, 243.56372446784894, 235.71824305576388, 220.7876297669875, 206.57120485446535, 197.20400634765633, 196.2358609391166, 190.4577120263915, 182.99779875186164, 179.31178587858108, 175.94675957847824, 162.12589991977768, 154.5639597064294, 146.29719859859824, 143.47133132853605, 119.73370853094639, 86.16128959392137, 74.67999877929685, 71.64618595027758, 68.09686497833002, 51.00903196778546, 43.339516199916375, 41.70001220703125]
# list = [7.381722836856113, 12.001724057559244, 23.981719785098306, 30.321719174746733, 28.561721616152994, 28.801721005801426, 30.70172100580143, 38.52172222650455, 36.33216156516869, 25.361721616153005, 16.441723447207693, 4.541721921328772, 1.2617216161529967, 4.089376682570844, 0.0]
list = [
    618.5,
    628.1200073242,
    641.5399902344,
    650.2399902344,
    652.9,
    654.584623452,
    657.984623452,
    663.2986620428,
    669.6211168186,
    672.4400024414,
    672.2200073242,
    676.6400024414,
    682.7599975586,
    682.734222462,
    687.4,
    692.0917761899,
    693.6706993858,
    704.7207035396,
    711.4347000383,
    721.3282705838,
    732.5354853218,
    737.6274541229,
    735.4599853516,
    738.4913107228,
    741.7793199818,
    736.5959265256,
    735.6457325766,
    744.1437475806,
    739.0454027609,
    744.627581418,
    755.3796915587,
    762.0452322189,
    766.5199951172,
    775.1943200702,
    779.7841829674,
    785.1841829674,
    786.8399902344,
    798.5471655209,
    821.7561584166,
    824.7354633805,
    817.7200073242,
    817.2200073242,
    827,
    837.12476878,
    843.52476878,
    845.900012207,
    852.493767752,
    862.5134578803,
    866.7400024414,
    879.3400146484,
    884.9757455206,
    900.5913969815,
    910.1601298947,
    916.4799926758,
    918.8043099087,
    933.1735468774,
    947.8100207773,
    957.4599975586,
    963.0800048828,
    970.7860517073,
    978.4421219898,
    990.2522660476,
    999.0921749735,
    1000.6894408582,
    1008.5081988087,
    1019.0051204668,
    1026.2912202449,
    1034.9746039822,
    1047.1297070702,
    1061.0346961616,
    1067.9799804688,
    1071.2519455509,
    1082.0690085175,
    1089.7599853516,
    1098.7051089379,
    1103.9208500578,
    1109.6340280085,
    1118.456852471,
    1131.6749057294,
    1151.0200195312,
    1156.3600097656,
    1168.6399902344,
    1172.7850423518,
    1182.9146557666,
    1178.2966948904,
    1181.9021139876,
    1200.2782223103,
    1212.9277283438,
    1213.6694130465,
    1229.7000244141,
    1234.9800292969,
    1242.7400146484,
    1252.1414021499,
    1264.9778286372,
    1270.2381828068,
    1275.2524170189,
    1283.3262144136,
    1289.8690826531,
    1302.5199707031,
    1308.136467104,
    1316.9227046655,
    1325.4312464974,
    1335.8101232725,
    1343.997852804,
    1350.9201841148,
    1352.7999755859,
    1355.1464003379,
    1358.2144465214,
    1376.2199951172,
    1386.3365824586,
    1395.5180359257,
    1399.0139286741,
    1413.5744163295,
    1420.5799087971,
    1426.5854729364,
    1437.6265928475,
    1441.4679828313,
    1446.8600097656,
    1455.9800048828,
    1462.1860793846,
    1455.1600097656,
    1448.0399902344,
    1439.322512798,
    1435.2400146484,
    1429.9,
    1423.3199951172,
    1425.4883680004,
    1416.6875373098,
    1406.0932512025,
    1400.2199951172,
    1389.7186668723,
    1384.8600097656,
    1373.6800048828,
    1374.6799804688,
    1371.8790956226,
    1358.4251869724,
    1351.1416365323,
    1344.5199707031,
    1336.1821852844,
    1328.4724626776,
    1319.3199951172,
    1312.0599853516,
    1303.1023950733,
    1295.1399902344,
    1293.2772835774,
    1279.9600097656,
    1269.2600097656,
    1257.7400146484,
    1250.3399902344,
    1246.2399902344,
    1238.3395892513,
    1231.0308538194,
    1224.9199951172,
    1209.0737811511,
    1199.5226872255,
    1195.7800048828,
    1193.63977748,
    1181.0225555479,
    1173.2984852212,
    1166.8482885481,
    1156.5831234336,
    1153.2249678902,
    1139.4992928553,
    1127.6201219135,
    1113.4267400379,
    1105.4799804688,
    1088.8599388226,
    1080.1479177039,
    1070.5,
    1064,
    1055.983162531,
    1051.4399902344,
    1041.2199951172,
    1032.2199951172,
    1023.6800048828,
    1018.0723412089,
    1010.4743309813,
    1006.8486863767
]

x = np.array(list)
# print(len(x))

from scipy.signal import find_peaks

# 元データのピークとプロミネンスの検出
peaks, properties = find_peaks(x, distance=3, prominence=5)
print("元データのピーク:", peaks)
print("元データのプロミネンス:", properties["prominences"])

# データを逆転
x_inverted = np.max(x) - x

# 逆転データのピークとプロミネンスの検出
peaks_inverted, properties_inverted = find_peaks(x_inverted, distance=3, prominence=5)
print("逆転データのピーク:", peaks_inverted)
print("逆転データのプロミネンス:", properties_inverted["prominences"])

# # 逆転データのピークを元のインデックスに戻す
# peaks_inverted_original_idx = len(x) - 1 - peaks_inverted
# print(peaks)
# print(peaks_inverted)

# グラフ描画
plt.figure(figsize=(12, 6))

# 元データをプロット
plt.plot(range(len(x)), x, marker='o', linestyle='-', markersize=4, label='Original')

# 元データのピークをプロット
plt.plot(peaks, x[peaks], "x", markersize=10, label='Peaks (Original)', color='red')

# 逆転したデータのピークを元のインデックスでプロット
plt.plot(peaks_inverted, x[peaks_inverted], "x", markersize=4, label='Peaks (Inverted)', color='orange')

# グラフ装飾
plt.title('Original Data with Inverted Peaks', fontsize=16)
plt.xlabel('Index', fontsize=12)
plt.ylabel('Value', fontsize=12)
plt.grid(True, linestyle='--', alpha=0.7)
plt.legend()

# グラフ表示
plt.tight_layout()
plt.show()





# # 逆転データのピークとプロミネンスの検出
# peaks_inverted, properties_inverted = find_peaks(x_inverted, distance=3, prominence=3)
# print("逆転データのピーク:", peaks_inverted)
# print("逆転データのプロミネンス:", properties_inverted["prominences"])

# # グラフ描画
# plt.figure(figsize=(12, 6))
# plt.plot(range(len(x)), x, marker='o', linestyle='-', markersize=8, label='Original')
# plt.plot(peaks, x[peaks], "x", markersize=10, label='Peaks (Original)', color='red')

# plt.plot(range(len(x_inverted)), x_inverted, marker='o', linestyle='-', markersize=8, label='Inverted', color='green')
# plt.plot(peaks_inverted, x_inverted[peaks_inverted], "x", markersize=10, label='Peaks (Inverted)', color='orange')

# # グラフ装飾
# plt.title('Original and Inverted Data with Peaks', fontsize=16)
# plt.xlabel('Index', fontsize=12)
# plt.ylabel('Value', fontsize=12)
# plt.grid(True, linestyle='--', alpha=0.7)
# plt.legend()

# # グラフ表示
# plt.tight_layout()
# plt.show()