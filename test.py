import numpy as np
import matplotlib.pyplot as plt

# 波形サンプル
# list = [0.0, 1.779998779296875, 2.5409911586590397, 11.452094103782827, 23.69999999999999, 31.071569018004595, 33.51195196560968, 37.60948515627604, 41.976800185598336, 42.13111687674689, 43.77999267578127, 45.04000244140627, 41.12249755859375, 47.158249069604835, 46.15882528382451, 43.08000488281249, 42.020001220703136, 39.56747441542558, 40.75999755859374, 41.44000244140625, 42.66000976562498, 41.186667887369765, 41.11333211263019, 34.62000732421876, 32.2600036621094, 31.899999999999977, 40.7399963378906, 43.12000732421876, 42.74000244140626, 42.74000244140626, 44.420001220703114, 45.6199951171875, 46.632884488878176, 41.88740830273548, 41.3008774377837, 47.43999633789065, 54.220001220703125, 61.10369907519606, 63.812712418102706, 62.979998779296864, 63.01307676472925, 59.04185328617348, 69.06000366210935, 71.24000244140626, 82.25440265100514, 82.16000366210938, 87.76673006671444, 93.05999755859375, 101.6400085449219, 104.64000244140624, 112.5434032063132, 114.54000244140627, 111.55999755859375, 112.10616425552308, 111.24540806383237, 112.65999755859377, 121.75427165088729, 120.66000366210938, 122.51998901367188, 123.41999511718751, 124.47999877929686, 130.1162311406685, 127.47561204505217, 136.11800697537348, 146.21513182686232, 159.7884973443597, 162.17999267578125, 165.86738972633543, 167.4025153588949, 171.04293032502858, 182.20285668862368, 189.62633398289086, 202.3509891258575, 213.16000976562498, 216.9428606305804, 220.338873342252, 229.50726653080756, 240.57258529165767, 243.57999267578123, 244.50422713901378, 249.04774411998937, 265.240115544638, 275.8327553068482, 284.73449086732603, 282.7740541723756, 295.3544899623324, 310.86114838161666, 321.2400024414062, 325.9000122070313, 333.8799926757813, 336.75751301512673, 347.36327992481836, 355.7400024414062, 364.4180077672072, 362.76021040579235, 371.954858312512, 382.4000122070313, 395.3856376677883, 394.17218757971125, 401.5135482411073, 408.99237626392755, 411.03999023437495, 417.7713563997602, 423.81999511718755, 431.75433973939107, 445.2698515631214, 461.26186367736284, 459.82619032956404, 450.29442738744206, 442.56000976562495, 439.0213246572674, 422.8375623349242, 407.91999511718745, 402.91066604936464, 396.37501140607424, 381.32249865670224, 378.26256834364256, 366.1863649743766, 353.93999023437505, 345.65998535156245, 335.7934926698938, 329.4813420566936, 322.8813420566937, 320.91325280684487, 311.9999877929688, 302.9254749292244, 287.7199951171875, 275.4066446940103, 271.1399780273438, 262.0666373312728, 257.5910259602091, 243.56372446784894, 235.71824305576388, 220.7876297669875, 206.57120485446535, 197.20400634765633, 196.2358609391166, 190.4577120263915, 182.99779875186164, 179.31178587858108, 175.94675957847824, 162.12589991977768, 154.5639597064294, 146.29719859859824, 143.47133132853605, 119.73370853094639, 86.16128959392137, 74.67999877929685, 71.64618595027758, 68.09686497833002, 51.00903196778546, 43.339516199916375, 41.70001220703125]
# list = [7.381722836856113, 12.001724057559244, 23.981719785098306, 30.321719174746733, 28.561721616152994, 28.801721005801426, 30.70172100580143, 38.52172222650455, 36.33216156516869, 25.361721616153005, 16.441723447207693, 4.541721921328772, 1.2617216161529967, 4.089376682570844, 0.0]
list = [0.0, 7.660021972656182, 26.9000244140625, 28.860021972656227, 43.42000732421877, 53.1400146484375, 63.62001953125002, 68.54000244140627, 78.10001220703123, 85.4466464048644, 91.3599975585937, 97.4799926757812, 98.1400268554687, 91.3992600424499, 82.72001953124993, 80.5, 95.39999999999998, 101.99425880657566, 107.6400146484375, 109.54172713748756, 108.83535484784295, 102.10933098464693, 107.90095114388771, 104.30095114388769, 106.96000976562493, 99.78000488281248, 95.49666748046877, 89.72666015624998, 88.20999755859373, 83.66000976562498, 79.11002197265623, 79.11240234374998, 86.0362880067961, 82.21349364677576, 61.64771255437222, 45.27328831561465, 54.72606353759761, 57.07876663208003, 56.22502136230469, 56.17501525878902, 57.01958140610236, 58.63621608864025, 47.880017089843705, 51.120007324218705, 54.22000732421873, 64.52000732421868, 71.3800048828125, 65.75998535156248]
x = np.array(list)
# print(len(x))

from scipy.signal import find_peaks

peaks, _ = find_peaks(x, distance=3, prominence=4.5)
# peaks, _ = find_peaks(x, distance=4, threshold=5)
print("ピークのインデックス")   
print(peaks)
# print(_["prominences"])
print("調査対象")
print(_)

# グラフの作成
plt.figure(figsize=(12, 6))
plt.plot(range(0, len(x)), x, marker='o', linestyle='-', markersize=8)

# 検出されたピークにマークを付ける
plt.plot(peaks, x[peaks], "x", markersize=10, label='Peaks', color='red')
# グラフの装飾
plt.title('prominence sample with peaks', fontsize=16)

# グラフの装飾
plt.title('prominence sample', fontsize=16)
plt.xlabel('Index', fontsize=12)
plt.ylabel('Value', fontsize=12)
plt.grid(True, linestyle='--', alpha=0.7)

# X軸を整数値に設定
plt.xticks(range(0, len(x)))

# グラフの表示
plt.tight_layout()
plt.show()
